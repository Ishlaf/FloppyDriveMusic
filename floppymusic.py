import RPi.GPIO as GPIO
import time

GPIO.setmode(GPIO.BCM)
GPIO.setwarnings(False)

class floppydrive:
    def __init__(self, maxsteps, s, d, l):
        self.maxsteps = maxsteps
        self.s = s
        self.d = d
        self.l = l
        self.pos = 1
        self.direction = 1

        GPIO.setup(s, GPIO.OUT)
        GPIO.setup(d, GPIO.OUT)
        GPIO.setup(l, GPIO.OUT)
        self.off()

    def change_direction(self):
        self.direction = -self.direction
        GPIO.output(self.d, 1-GPIO.input(self.d))

    def step(self):
        if (self.pos == 1 and self.direction == -1) or (self.pos == self.maxsteps and self.direction == 1):
            self.change_direction()

        GPIO.output(self.s, 0)
        GPIO.output(self.s, 1)
        GPIO.output(self.s, 0)

        self.pos += self.direction

    def reset(self):
        self.on()
        GPIO.output(self.d, 1)
        for i in range(self.maxsteps*5):
            GPIO.output(self.s, 0)
            GPIO.output(self.s, 1)
            time.sleep(.01)
        self.off()

    def on(self):
        GPIO.output(self.l,0)

    def off(self):
        GPIO.output(self.l,1)

def note(htz, t, d):
     l = 1.0/htz
     times = htz*t
     d.on()
     for i in range(int(times)):
             d.step()
             time.sleep(l)
     time.sleep(.05)
     d.off()

def mary(drive):
    note(330, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(262, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 2, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(294, 2, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 2, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(262, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(262, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(330, 1, drive)
    time.sleep(0.05)
    note(294, 1, drive)
    time.sleep(0.05)
    note(262, 2, drive)
    time.sleep(0.05)

def imperial(drive):
    note(98,.5,drive)
    note(98,.5,drive)
    note(98,.5,drive)
    note(82.41,.375,drive)
    note(116.54,.125,drive)
    note(98,.5,drive)
    note(82.41,.375,drive)
    note(116.54,.125,drive)
    note(98,1,drive)

def cantina(drive):
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    time.sleep(.25)
    note(207.65, .25, drive)
    note(220, .5, drive)
    note(220, .25, drive)
    note(207.65, .25, drive)
    note(220, .25, drive)
    note(196, .25, drive)
    time.sleep(.25)
    note(185, .25, drive)
    note(196, .25, drive)
    note(185, .25, drive)
    note(174.61, .75, drive)
    note(146.83, .25, drive)
    note(146.83, 1, drive)
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    time.sleep(.25)
    note(207.65, .25, drive)
    note(220, .5, drive)
    note(196, .25, drive)
    time.sleep(.25)
    note(196, .75, drive)
    note(185, .25, drive)
    note(196, .5, drive)
    note(261.63, .25, drive)
    note(233.08, .5, drive)
    note(220, .5, drive)
    note(196, .75, drive)
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .5, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    note(293.66, .5, drive)
    note(220, .25, drive)
    time.sleep(.25)
    note(207.65, .25, drive)
    note(220, .5, drive)
    note(261.63, .25, drive)
    time.sleep(.25)
    note(261.63, .75, drive)
    note(220, .25, drive)
    note(196, .5, drive)
    note(174.61, .5, drive)
    note(146.83, 1.25, drive)
    note(146.83, 1, drive)
    note(174.61, 1, drive)
    note(220, 1, drive)
    note(261.63, 1, drive)
    note(311.13, .5, drive)
    note(293.66, .5, drive)
    note(207.65, .25, drive)
    note(220, .5, drive)
    note(174.61, 2.25, drive)
    time.sleep(.25)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(440, .5, drive)
    time.sleep(.75)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(440, .5, drive)
    time.sleep(.75)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(415.3, .25, drive)
    note(440, .5, drive)
    note(349.23, 1.25, drive)
    note(293.66, 1, drive)
    time.sleep(.25)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(440, .5, drive)
    time.sleep(.75)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(440, .5, drive)
    time.sleep(.75)
    note(440, .5, drive)
    note(349.23, .25, drive)
    note(415.3, .25, drive)
    note(392, .5, drive)
    note(392, 1.25, drive)
    note(261.63, 1, drive)
